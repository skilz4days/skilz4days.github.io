<!DOCTYPE html>
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=UTF=8' />
<meta name='viewport' content='width=device-width, maximum-scale=1.0, minimum-scale=1.0, initial-scale=1.0' />
<meta name='ad.size' content='width=300,height=250' />
<script type='text/javascript'> var clickTag ='blank'; </script>
<title></title>


<!-- CSS -->
<style>
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{border:0;font-size:100%;font:inherit;vertical-align:baseline;margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:none}table{border-collapse:collapse;border-spacing:0}
body {
	-webkit-transform: translate3d(0, 0, 0);
	-ms-transform: translate3d(0, 0, 0);
	transform: translate3d(0, 0, 0);
    margin: 0;
    padding: 0;
}
img{
	display:block;
}
a {
    text-decoration: none;
}
sup{
    position: absolute;
    vertical-align: super;
}
#main {
	width: 300px;
	height: 250px;
	background-color: #FFF;
	background-repeat: no-repeat;
	position: relative;
	overflow: hidden;
	display: none;
}
.main div {
	position: absolute;
}
#border{
	cursor: pointer; cursor: hand;
}
#border{
	width: 298px;
	height: 248px;
    border-style: solid;
    border-width: 1px;
    border-color: #bbb;
}
#placard {
    width: 514px;
    height: 86px;
    overflow: hidden;
    position:absolute;
    /*background: rgba(255,0,0,0.4);*/
}

#placard_inner {
	position: absolute;
}

#cta {
	overflow: hidden;
}

#snowflakeContainer {
    position: absolute;
    left: 0px;
    top: 0px;
}
.snowflake {
    padding-left: 15px;
    font-family: Cambria, Georgia, serif;
    font-size: 14px;
    line-height: 24px;
    position: fixed;
    color: #FFFFFF;
    user-select: none;
    z-index: 1000;
}
.snowflake:hover {
    cursor: default;
}

</style>
</head>


<body>


<!-- div layering -->
<div id='main' class='main'>
	<a href='javascript:window.open(window.clickTag)'>
		<div id='banner'>
			<div id='bg_and_mountain'><img src='bg_and_mountain.jpg' id='bg_and_mountain_img'/></div>
			<div id='logo'><img src='logo.png' id='logo_img'/></div>
			<div id='placard'>
				<div id='placard_inner'><img src='placard.png' id='placard_img'/></div>
			</div>
			<div id='box_fake_bottom'><img src='box_inner.png' id='box_inner_img'/></div>
			<div id='bottle_4'><img src='bottle4.png' id='bottle_4_img'/></div>
			<div id='bottle_3'><img src='bottle3.png' id='bottle_3_img'/></div>
			<div id='bottle_2'><img src='bottle2.png' id='bottle_2_img'/></div>
			<div id='bottle_1'><img src='bottle1.png' id='bottle_1_img'/></div>
			<div id='box'>
					<div id='box_top'>
						<div id='box_top_inner'><img src='box_inner.png' id='box_inner_img'/></div>
						<img src='box_top.jpg' id='box_top_img'/>
					</div>
					<div id='box_side_1'>
						<div id='box_side_1_inner'><img src='box_inner.png' id='box_inner_img'/></div>
						<img src='box_side.jpg' id='box_side_1_img'/>
					</div>
					<div id='box_side_2'>
						<div id='box_side_2_inner'><img src='box_inner.png' id='box_inner_img'/></div>
						<img src='box_side.jpg' id='box_side_2_img'/>
					</div>
					<div id='box_side_3'>
						<div id='box_side_3_inner'><img src='box_inner.png' id='box_inner_img'/></div>
						<img src='box_side.jpg' id='box_side_3_img'/>
					</div>
					<div id='box_side_4'>
						<div id='box_side_4_inner'><img src='box_inner.png' id='box_inner_img'/></div>
						<img src='box_side.jpg' id='box_side_4_img'/>
					</div>
					<div id='box_bottom'>
						<div id='box_bottom_inner'><img src='box_inner.png' id='box_inner_img'/></div>
						<img src='box_bottom.jpg' id='box_bottom_img'/>
					</div>
			</div>
			<div id='snowflakeContainer'>
			    <div class='snowflake1' id='snowflake1'><img src='snow_1.png' id='snow_1_img'/></div>
			    <div class='snowflake2' id='snowflake2'><img src='snow_2.png' id='snow_2_img'/></div>
			    <div class='snowflake3' id='snowflake3'><img src='snow_3.png' id='snow_3_img'/></div>
			    <div class='snowflake4' id='snowflake4'><img src='snow_4.png' id='snow_4_img'/></div>
			    <div class='snowflake5' id='snowflake5'><img src='snow_5.png' id='snow_5_img'/></div>
			</div>
			<div id='cta'>
				<div id='cta_base'><img src='cta_base.png' id='cta_base_img' /></div>
				<div id='cta_flare'><img src='cta_flare.png' id='cta_flare_img' /></div>
			</div>
			<div id='border'></div>
		</div>
</div>


<!-- javascript animation includes -->
<script src='CSSPlugin.min.js'></script>
<script src='EasePack.min.js'></script>
<script src='TweenLite.min.js'></script>
<script src='FallingSnow.js'></script>


<!-- assure images are all preloaded -->
<script type='text/javascript'>
var main =  document.getElementById('main');
main.style.display = 'none';
var imageIdList = new Array ( 	
								'bg_and_mountain_img',
								'logo_img',
								'placard_img',
								'box_top_img',
								'box_bottom_img',
								'box_side_1_img',
								'box_side_2_img',
								'box_side_3_img',
								'box_side_4_img',
								'box_inner_img',
								'bottle_1_img',
								'bottle_2_img',
								'bottle_3_img',
								'bottle_4_img',
								'cta_base_img',
								'cta_flare_img',
								'snow_1_img',
								'snow_2_img',
								'snow_3_img',
								'snow_4_img',
								'snow_5_img'
							);
var checkLoadInterval = setInterval( checkLoad, 50 );
function checkLoad () {
	var totalImages = imageIdList.length;
	var imageLoadCount = 0;
	for (;totalImages--;) {
		var theImage = document.getElementById(imageIdList[totalImages]);
		var rh = theImage.naturalHeight;
		if (rh) {
			imageLoadCount++;
		}
	}
	if ( imageLoadCount >= imageIdList.length ) {
		clearInterval( checkLoadInterval );
		initAnimation();
	}
}

function initAnimation () {

	// define variables
	var t = TweenLite;
	var stageWidth = 300;
	var stageHeight = 250;
	var phase = 0;
	var frameCount = 0;
	var transitionTime = 1;
	var ctaIsVisible = false;
	var maxLoops = 2;
	var currentLoop = 1;	
	
	var bgAndMountain = document.getElementById('bg_and_mountain');
	var logo = document.getElementById('logo');
	var placard = document.getElementById('placard');
	var placardInner = document.getElementById('placard_inner');
	var box = document.getElementById('box');
	var boxOffsetter = document.getElementById('box_offsetter');
	var boxTop = document.getElementById('box_top');
	var boxSide1 = document.getElementById('box_side_1');
	var boxSide2 = document.getElementById('box_side_2');
	var boxSide3 = document.getElementById('box_side_3');
	var boxSide4 = document.getElementById('box_side_4');
	var boxBottom = document.getElementById('box_bottom');
	var boxTopInner = document.getElementById('box_top_inner');
	var boxSide1Inner = document.getElementById('box_side_1_inner');
	var boxSide2Inner = document.getElementById('box_side_2_inner');
	var boxSide3Inner = document.getElementById('box_side_3_inner');
	var boxSide4Inner = document.getElementById('box_side_4_inner');
	var boxBottomInner = document.getElementById('box_bottom_inner');
	var boxFakeBottom = document.getElementById('box_fake_bottom');
	var bottle1 = document.getElementById('bottle_1');
	var bottle2 = document.getElementById('bottle_2');
	var bottle3 = document.getElementById('bottle_3');
	var bottle4 = document.getElementById('bottle_4');
	var cta = document.getElementById('cta');
	var ctaBase = document.getElementById('cta_base');
	var ctaFlare = document.getElementById('cta_flare');
	var snowflakeContainer = document.getElementById('snowflakeContainer');
	var border = document.getElementById('border');

	var boxSize = 260; 
	var offsetX = -boxSize/2;
	var offsetY = -boxSize/2;
	var offsetZ = boxSize/2;
	var boxOpenTime = .9;
	var boxCascade = 0.1;
	var boxFadeOutTime = 1.2;
	var delayOffset = 0.8;
	var bottlePanTime = 1.5;

	var isIE = (navigator.appVersion.indexOf("MSIE") != -1 || navigator.appVersion.indexOf("Trident") != -1) ? true : false;

	//fix for chrome browser scaling bug
	var _numExp = /(?:\-|\.|\b)(\d|\.|e\-)+/g;
	function altTransform() {
		var e = this.target.nodeType ? this.target : this._targets[0],
			nums = e.style.transform.match(_numExp),
			z;
		if (nums.length === 16 && nums[14]) {
			z = nums[14];
			nums[14] = "0";
			e.style.transform = "translateZ(" + z + "px) matrix3d(" + nums.join(",") + ")";
		}
	}

	// initial setup
	hide(bgAndMountain);
	hide(logo);
	hide(placard);
	hide(box);
	hide(boxFakeBottom);
	hide(bottle1);
	hide(bottle2);
	hide(bottle3);
	hide(bottle4);
	hide(cta);
	hide(border);

	advance();

	function advance () {
		    
		if ( phase == 0 ) {

		    show(main);
		    show(border);

		    show(bgAndMountain);
			t.set(bgAndMountain, {x:0, y:0, scale:0.5, transformOrigin:'top left'});

		    show(logo);
			t.set(logo, {x:0, y:0, scale:0.5, alpha:1.0, transformOrigin:'top left'});
			t.to(logo, 0.6, {x:0, y:0, scale:0.5, alpha:1.0, ease:Expo.easeOut});

		    show(placard);
		    t.set(placard, {x:22, y:275, scale:0.5, alpha:1.0, transformOrigin:'top left'});
			t.set(placardInner, {x:0});
			t.to(placard, 0.8, {y:110, ease:Expo.easeOut, delay:0.2});

			t.set(snowflakeContainer, {x:-50, y:-50})
			
			delay(1.4);
		}
		else if ( phase == 1 ) {

			if (isIE)
			{
				show(box);

				//reset box in 3D
				hide(boxTopInner);
				hide(boxSide1Inner);
				hide(boxSide2Inner);
				hide(boxSide3Inner);
				hide(boxSide4Inner);
				hide(boxBottomInner);
				hide(boxFakeBottom);	
				
				t.set(box, {clearProps:'all'});
				t.set(boxTop, {clearProps:'all'});

				t.set(box, {x:300, y:71, scaleX:0.5, scaleY:0.5, ease:Expo.easeOut}); 					
				t.to(box, 1.45, {x:85, scaleX:0.5, scaleY:0.5, ease:Expo.easeOut, delay:0.05});

				t.to(placard, 0.65, {x:-150, ease:Expo.easeInOut, delay:0.01});
				t.to(placardInner, 0.65, {x:600, ease:Expo.easeInOut, delay:0.01});

				delay(2.0);
			}
			else
			{
				show(box);

				//reset box in 3D
				hide(boxTopInner);
				hide(boxSide1Inner);
				hide(boxSide2Inner);
				hide(boxSide3Inner);
				hide(boxSide4Inner);
				hide(boxBottomInner);
				hide(boxFakeBottom);	
				
				t.set(box, {clearProps:'all'});
				t.set(boxTop, {clearProps:'all'});
				t.set(boxSide1, {clearProps:'all'});
				t.set(boxSide2, {clearProps:'all'});
				t.set(boxSide3, {clearProps:'all'});
				t.set(boxSide4, {clearProps:'all'});
				t.set(boxBottom, {clearProps:'all'});

				t.set(box, {x:500, y:107, scaleX:0.02, scaleY:0.02, scaleZ:0.02, rotationX:142, rotationZ:28, ease:Expo.easeOut, transformStyle:'preserve-3d', webkitBackfaceVisibility:'hidden', onUpdate:altTransform}); 	
				
				t.to(box, 1.45, {x:150, y:154, rotationX:-41, rotationY:-760, rotationZ:29, scaleX:0.42, scaleY:0.42, scaleZ:0.42, ease:Expo.easeOut, transformStyle:'preserve-3d', webkitBackfaceVisibility:'hidden', onUpdate:altTransform});
				t.to(box, 1.25, {x:150, y:137, rotationX:-90, rotationY:-720, rotationZ:0, scaleX:0.5, scaleY:0.5, scaleZ:0.5, ease:Expo.easeInOut, transformStyle:'preserve-3d', webkitBackfaceVisibility:'hidden', onUpdate:altTransform, delay:1.5});
		
				t.set(boxTop, 		{x:offsetX, 			y:offsetY, 		z:-boxSize+offsetZ, 	rotationX:90, 	alpha:1.0,		transformOrigin:'top left', onUpdate:altTransform});
				t.set(boxSide1, 	{x:offsetX,				y:offsetY,		z:offsetZ,		 						alpha:1.0,		transformOrigin:'top left', onUpdate:altTransform});
				t.set(boxSide2, 	{x:boxSize+offsetX, 	y:offsetY,		z:offsetZ, 				rotationY:90,	alpha:1.0,		transformOrigin:'top left', onUpdate:altTransform});
				t.set(boxSide3, 	{x:boxSize+offsetX,		y:offsetY,		z:-boxSize+offsetZ, 	rotationY:180, 	alpha:1.0,		transformOrigin:'top left', onUpdate:altTransform});
				t.set(boxSide4, 	{x:offsetX,				y:offsetY,		z:-boxSize+offsetZ, 	rotationY:-90, 	alpha:1.0,		transformOrigin:'top left', onUpdate:altTransform});
				t.set(boxBottom, 	{x:offsetX,				y:offsetY,		z:-boxSize+offsetZ, 	rotationX:-90, 	alpha:1.0,		transformOrigin:'bottom left', onUpdate:altTransform});

				t.to(placard, 0.65, {x:-150, ease:Expo.easeInOut, delay:0.05});
				t.to(placardInner, 0.65, {x:600, ease:Expo.easeInOut, delay:0.05});

				delay(2.6);
			}
			
		}
		else if ( phase == 2 ) {

			if (isIE)
			{
				t.to(box, boxOpenTime/2, {alpha:0.0, ease:Expo.easeOut, webkitBackfaceVisibility:'hidden'});

				show(bottle1);
				t.set(bottle1, {x:112, y:79, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(bottle2);
				t.set(bottle2, {x:115, y:83, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(bottle3);
				t.set(bottle3, {x:115, y:83, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(bottle4);
				t.set(bottle4, {x:115, y:83, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(boxFakeBottom);
				t.set(boxFakeBottom, {x:150-boxSize/2, y:137-boxSize/2, scale:0.5, alpha:1.0, ease:Expo.easeInOut});
			
				delay(boxOpenTime/2);

			}
			else
			{
				show(boxTop);
				t.to(boxTop, boxOpenTime/2, {rotationZ:90, transformOrigin:'top right', ease:Linear.easeNone, onUpdate:altTransform});

				t.to(boxSide1, boxOpenTime*2, {rotationX:30, transformOrigin:'top left', ease:Linear.easeNone, onUpdate:altTransform});
				t.to(boxSide3, boxOpenTime*2, {rotationX:30, transformOrigin:'top left', ease:Linear.easeNone, onUpdate:altTransform});
				t.to(boxSide4, boxOpenTime*2, {rotationX:30, transformOrigin:'top left', ease:Linear.easeNone, onUpdate:altTransform});

				show(bottle1);
				t.set(bottle1, {x:112, y:79, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(bottle2);
				t.set(bottle2, {x:115, y:83, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(bottle3);
				t.set(bottle3, {x:115, y:83, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(bottle4);
				t.set(bottle4, {x:115, y:83, scale:0.5, alpha:1.0, transformOrigin:'top left'});

				show(boxSide1Inner);
				show(boxSide2Inner);
				show(boxSide3Inner);
				show(boxSide4Inner);
				hide(boxBottom);

				show(boxFakeBottom);
				t.set(boxFakeBottom, {x:150-boxSize/2, y:137-boxSize/2, scale:0.5, alpha:1.0, ease:Expo.easeInOut});
			
				delay(boxOpenTime/2);
			}
		}
		else if ( phase == 3 ) {

			show(boxTopInner);

			t.to(boxTop, boxOpenTime, {x:offsetX+boxSize, rotationZ:180, transformOrigin:'top right', ease:Linear.easeNone, onUpdate:altTransform});
			t.to(boxSide2, boxOpenTime, {rotationX:180, transformOrigin:'top left', ease:Linear.easeNone, onUpdate:altTransform});

			t.to(boxSide1, boxOpenTime*2, {rotationX:180, transformOrigin:'top left', ease:Linear.easeNone, delay:0.3, onUpdate:altTransform});
			t.to(boxSide3, boxOpenTime*2, {rotationX:180, transformOrigin:'top left', ease:Linear.easeNone, delay:0.3, onUpdate:altTransform});
			t.to(boxSide4, boxOpenTime*2, {rotationX:180, transformOrigin:'top left', ease:Linear.easeNone, delay:0.3, onUpdate:altTransform});

			t.to(boxTop,   boxFadeOutTime*.2, {alpha:0, ease:Expo.easeOut, overwrite:false, delay:boxOpenTime-delayOffset, onUpdate:altTransform});
			t.to(boxSide1, boxFadeOutTime, {alpha:0, ease:Expo.easeOut, overwrite:false, delay:boxOpenTime-delayOffset, onUpdate:altTransform});
			t.to(boxSide2, boxFadeOutTime, {alpha:0, ease:Expo.easeOut, overwrite:false, delay:boxOpenTime-delayOffset, onUpdate:altTransform});
			t.to(boxSide3, boxFadeOutTime, {alpha:0, ease:Expo.easeOut, overwrite:false, delay:boxOpenTime-delayOffset, onUpdate:altTransform});
			t.to(boxSide4, boxFadeOutTime, {alpha:0, ease:Expo.easeOut, overwrite:false, delay:boxOpenTime-delayOffset, onUpdate:altTransform});
			t.to(boxFakeBottom, boxFadeOutTime, {alpha:0, ease:Expo.easeOut, overwrite:false, delay:boxOpenTime-delayOffset, onUpdate:altTransform});

			t.to(box, 1.0, {scaleX:0.4, scaleY:0.4, scaleZ:0.4, ease:Linear.easeNone, transformStyle:'preserve-3d', webkitBackfaceVisibility:'hidden',delay:boxOpenTime-delayOffset, onUpdate:altTransform});
			t.to(boxFakeBottom, 1.0, {scale:0.4, ease:Linear.easeNone, transformStyle:'preserve-3d', webkitBackfaceVisibility:'hidden',delay:boxOpenTime-delayOffset});

			delay(0.05);
		}
		else if ( phase == 4 ) {

			t.to(bgAndMountain, bottlePanTime, {x:0, y:-27, ease:Expo.easeInOut});

			t.to(bottle1, bottlePanTime, {x:35, y:69, ease:Expo.easeInOut});
			t.to(bottle2, bottlePanTime, {x:92, y:72, ease:Expo.easeInOut});
			t.to(bottle3, bottlePanTime, {x:146, y:74, ease:Expo.easeInOut});
			t.to(bottle4, bottlePanTime, {x:201, y:78, ease:Expo.easeInOut});

			show(cta);
			t.set(cta, {x:108, y:260, width:168, height:60, scale:0.5, alpha:1.0, transformOrigin:'top left'});
			t.to(cta, bottlePanTime, {y:206, ease:Expo.easeInOut, delay:0.1, transformOrigin:'top left'});
			t.set(ctaFlare, {x:-150});

			delay(bottlePanTime - .4);
		}
		else if (phase == 5) {

    		ctaIsVisible = true;
			goCTAFlare();

			delay(1.3);
		}
		else if (phase == 6) {
		    
    		if (currentLoop < maxLoops)
    		{
    			var resetTime = 1.1;
    			var resetCascade = 0.1;

				t.to(bgAndMountain, resetTime, {y:0, ease:Expo.easeInOut});
				t.to(bottle1, resetTime, {x:125, y:275, ease:Expo.easeInOut});
				t.to(bottle2, resetTime, {x:125, y:275, ease:Expo.easeInOut, delay:resetCascade});
				t.to(bottle3, resetTime, {x:125, y:275, ease:Expo.easeInOut, delay:resetCascade*2});
				t.to(bottle4, resetTime, {x:125, y:275, ease:Expo.easeInOut, delay:resetCascade*3});
				t.to(cta, resetTime, {y:275, ease:Expo.easeInOut});

	   			ctaIsVisible = false;
    			phase = -1;
    			currentLoop++

				delay(resetTime-.3);
    		}
    		else {
    			//stop snow
    			allowSnowMovement = false;
    		}
		}
    }

    function goCTAFlare () {
		t.set(ctaFlare, {x:-150});
		t.to(ctaFlare, 1.8, {x:200, ease:Expo.easeOut})
    }

	border.onmouseover = function() {
		if (!ctaIsVisible) return;
		goCTAFlare();
	}

	border.onmouseout = function() {
		if (!ctaIsVisible) return;
	}
	
	border.onclick = function() {
		t.to(cta, 0.6, { scale:0.5, ease:Expo.easeOut});
	}

	// utility functions
	function hide(element) {
		element.style.display = 'none';
	}
	
	function show(element) {
		element.style.display = 'block';
	}
	
	// returns the distance from the left side of the banner to the left side of the element in question
	function getX(element) { 
		var mainRect = main.getBoundingClientRect();
		var elemRect = element.getBoundingClientRect();
		return elemRect.left - mainRect.left;
	}

	// returns the distance from the top of the banner to the top of the element in question
	function getY(element) { 
    	var mainRect = main.getBoundingClientRect();
    	var elemRect = element.getBoundingClientRect();
    	return elemRect.top - mainRect.top;
    }

	function delay(time) {
	    t.delayedCall(time, advance);
	    phase++;
	}
}
</script>


</body>
</html>

